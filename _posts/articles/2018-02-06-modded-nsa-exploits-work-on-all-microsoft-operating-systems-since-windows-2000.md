---
layout: post
title: Modded NSA Exploits Work on All Microsoft Operating Systems Since Windows 2000
date: 2018-02-06 18:32
author: nvinside
comments: true
categories: [EternalBlue, Exploit, NSA, Security, SHadow Brokers]
---
Another Day and another leak - Yes we are still seen waves coming from the NSA exploit leakage last year - Am I worried, hell no because the good thing is that the holes getting detected and we can fix it! So the good thing is that people getting a higher attention because the word 'NSA' in it and might reading the article which is exactly why I wrote it, to make people aware of the current situation.

[caption id="attachment_2637" align="alignnone" width="960"]<img class="alignnone size-full wp-image-2637" src="https://chefkochblog.files.wordpress.com/2018/02/src-adapt-960-high-nsa-leaks-web-banner-960x252-1401378826716.jpg" alt="src.adapt.960.high.NSA LEAKS Web Banner 960x252.1401378826716" width="960" height="252" /> Picture: <a href="http://america.aljazeera.com/content/ajam/topics/topic/organization/nsa/jcr:content/targetParsys/adaptiveimage/src.adapt.960.high.NSA%20LEAKS%20Web%20Banner%20960x252.1401378826716.jpg" target="_blank" rel="noopener">america.aljazeera.com</a>[/caption]

<!--more-->

A security researcher has made three leaked NSA exploits work on all versions of Windows since Windows 2000 up to the latest Windows 10 versions. These exploits were leaked last year by <strong>The Shadow Brokers</strong>. This is the same group that had leaked the notorious <strong>EternalBlue exploit</strong> that was used to power the biggest online ransomware campaign this industry has seen so far. The three exploits in question now include EternalChampion, EternalRomance, and EternalSynergy, all of which were leaked by TSB in April, last year. One security researcher has now worked on the source code to make all of these run on all Windows versions released in the last two decades for “the purposes of academic research and for the development of effective defensive techniques”.

<h2>Source Code and Protection</h2>

The source code is available on <a href="https://github.com/rapid7/metasploit-framework/pull/9473" target="_blank" rel="noopener">GitHub</a>, and from my tests Windows Defender is already aware of it and blocks the attack via it's network scanning module as long as you set UAC to high and enable SmartScreen protection the additional payload can't be loaded or executed.

[caption id="attachment_2645" align="aligncenter" width="387"]<img class=" size-full wp-image-2645 aligncenter" src="https://chefkochblog.files.wordpress.com/2018/02/4014206_en_1.png" alt="4014206_en_1" width="387" height="342" /> Ensure it's turned off - Windows 1709 and later using SMB v2 by default.[/caption]

<ul>
    <li><strong>TCP</strong>: 445</li>
    <li><strong>UDP</strong>: 137, 138 &amp; TCP ports 137, 139 (NetBIOS over TCP/IP)</li>
    <li>On several legacy protocols such as <a title="NetBIOS Frames protocol" href="https://en.wikipedia.org/wiki/NetBIOS_Frames_protocol">NBF</a>, <a title="IPX/SPX" href="https://en.wikipedia.org/wiki/IPX/SPX">IPX/SPX</a>.</li>
</ul>

<h3 class="title">Disabling Windows Script Host</h3>

This will stop the payload from been loaded/executed. The original article can be found <a href="https://technet.microsoft.com/en-us/library/ee198684.aspx" target="_blank" rel="noopener">here</a>.

<code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows Script Host\Settings\Enabled</code>

In the right panel, you will see <strong>Enabled</strong>. If you see the entry <strong>0</strong>, it means that the Windows Script Host access is disabled on your Windows machine.

Double Click on it and give it Value Data <strong>1</strong> to enable it.

<ul>
    <li>A value of <strong>1</strong> will enable Windows Script Host</li>
    <li>A value of <strong>0</strong> will disable Windows Script Host.</li>
</ul>

Click on OK and exit the Registry. If you don’t see this entry, then you may need to create it, as it does not exist by default in Windows.

<h2>Conclusion</h2>

The exploit is dangerous and can be abused, I'm sure right as I wrote this article here, someone tried to abuse it for evil reasons but as long your NAT and Windows own mechanism are set to the highest settings you should be secure, sadly these days there less pages which really showing you what you should do to avoid such things, blocking the SMB protocol with the windows own firewall still seems for most people enough unless you really work with SMB. But you might should consider to switch to more secure alternatives.<code></code>
